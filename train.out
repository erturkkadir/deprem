============================================================
EARTHQUAKE PREDICTION - HYBRID TRAINING
============================================================
Device: cuda
Input: M2.0+  |  Targets: M4.0+
Batch: 2  |  Seq len: 512  |  Embed: 1176
Print every: 200  |  Save every: 600
Learning rate: 0.0001
============================================================
[2026-02-16 18:36:58.466981] Loading hybrid data (M2.0+ input, M4.0+ targets)...
Database connection established
Loaded 1,493,886 records (M2.0+)
  Training targets (M4.0+): 521,292 (34.9%)
  Earth-state features: hour[0-23], doy[0-365], moon_phase[0-29], moon_dist[0-9]
  Warning: depth max 651 exceeds model limit 200, will be clamped

[2026-02-16 18:37:30.534314] Creating model with Geographic Positional Encoding (GPE)...
Model parameters: 270,498,666
Starting from scratch

[2026-02-16 18:37:37.003907] Training started (MULTI-POSITION)...
LR schedule: warmup 2000 optimizer steps, cosine decay to 500000
Gradient accumulation: 16 steps (effective batch=32)
Label smoothing: 0.1
Multi-position: loss at ALL M4+ positions per sequence

step    200 | train 18.0891 | val 15.7295 | lr 6.00e-07 | tgt 394 | lat 5.25 lon 5.93 mag 4.58 hav 4.67
  -> New best val loss!
step    400 | train 18.0821 | val 15.7372 | lr 1.20e-06 | tgt 395 | lat 5.25 lon 5.93 mag 4.57 hav 4.67
step    600 | train 18.0803 | val 15.7163 | lr 1.85e-06 | tgt 405 | lat 5.25 lon 5.93 mag 4.57 hav 4.67
  -> New best val loss!
[2026-02-16 18:45:24.176552] Checkpoint saved: /var/www/syshuman/quake/eqModel_complex_20260216_184516.pth (iter=600, loss=18.0803)
step    800 | train 18.0647 | val 15.6892 | lr 2.45e-06 | tgt 403 | lat 5.24 lon 5.93 mag 4.56 hav 4.67
  -> New best val loss!
step   1000 | train 18.0494 | val 15.6431 | lr 3.10e-06 | tgt 401 | lat 5.24 lon 5.92 mag 4.56 hav 4.67
  -> New best val loss!
step   1200 | train 18.0206 | val 15.6178 | lr 3.70e-06 | tgt 398 | lat 5.23 lon 5.91 mag 4.54 hav 4.67
  -> New best val loss!
[2026-02-16 18:53:40.163562] Checkpoint saved: /var/www/syshuman/quake/eqModel_complex_20260216_185303.pth (iter=1200, loss=18.0206)
step   1400 | train 17.9929 | val 15.5812 | lr 4.35e-06 | tgt 400 | lat 5.23 lon 5.91 mag 4.52 hav 4.67
  -> New best val loss!
step   1600 | train 17.9655 | val 15.5393 | lr 4.95e-06 | tgt 402 | lat 5.22 lon 5.90 mag 4.51 hav 4.67
  -> New best val loss!
step   1800 | train 17.9245 | val 15.4995 | lr 5.60e-06 | tgt 405 | lat 5.21 lon 5.89 mag 4.49 hav 4.67
  -> New best val loss!
[2026-02-16 19:01:54.269812] Checkpoint saved: /var/www/syshuman/quake/eqModel_complex_20260216_190118.pth (iter=1800, loss=17.9245)
step   2000 | train 17.8889 | val 15.4348 | lr 6.20e-06 | tgt 393 | lat 5.20 lon 5.88 mag 4.47 hav 4.67
  -> New best val loss!
step   2200 | train 17.8371 | val 15.3541 | lr 6.85e-06 | tgt 397 | lat 5.19 lon 5.87 mag 4.45 hav 4.66
  -> New best val loss!
