============================================================
EARTHQUAKE PREDICTION - HYBRID TRAINING
============================================================
Device: cuda
Input: M2.0+  |  Targets: M4.0+
Batch: 2  |  Seq len: 512  |  Embed: 1176
Print every: 200  |  Save every: 600
Learning rate: 0.0001
============================================================
[2026-02-11 23:39:12.348343] Loading hybrid data (M2.0+ input, M4.0+ targets)...
Database connection established
Loaded 1,492,239 records (M2.0+)
  Training targets (M4.0+): 520,936 (34.9%)
  Earth-state features: hour[0-23], doy[0-365], moon_phase[0-29], moon_dist[0-9]
  Warning: depth max 651 exceeds model limit 200, will be clamped

[2026-02-11 23:39:44.249842] Creating model with Geographic Positional Encoding (GPE)...
Model parameters: 270,498,666
Starting from scratch

[2026-02-11 23:39:53.555254] Training started (MULTI-POSITION)...
LR schedule: warmup 2000 optimizer steps, cosine decay to 500000
Gradient accumulation: 16 steps (effective batch=32)
Label smoothing: 0.1
Multi-position: loss at ALL M4+ positions per sequence

step    200 | train 15.7196 | val 15.7283 | lr 6.00e-07 | tgt 404 | lat 5.25 lon 5.93 mag 4.55
  -> New best val loss!
step    400 | train 15.7146 | val 15.7078 | lr 1.20e-06 | tgt 411 | lat 5.25 lon 5.93 mag 4.54
  -> New best val loss!
step    600 | train 15.7044 | val 15.6969 | lr 1.85e-06 | tgt 395 | lat 5.24 lon 5.93 mag 4.53
  -> New best val loss!
[2026-02-11 23:48:47.486703] Checkpoint saved: /var/www/syshuman/quake/eqModel_complex_20260211_234839.pth (iter=600, loss=15.7044)
step    800 | train 15.6825 | val 15.6561 | lr 2.45e-06 | tgt 403 | lat 5.24 lon 5.92 mag 4.52
  -> New best val loss!
step   1000 | train 15.6631 | val 15.6299 | lr 3.10e-06 | tgt 389 | lat 5.24 lon 5.92 mag 4.51
  -> New best val loss!
step   1200 | train 15.6347 | val 15.5746 | lr 3.70e-06 | tgt 401 | lat 5.23 lon 5.91 mag 4.49
  -> New best val loss!
[2026-02-11 23:58:36.366671] Checkpoint saved: /var/www/syshuman/quake/eqModel_complex_20260211_235802.pth (iter=1200, loss=15.6347)
step   1400 | train 15.6016 | val 15.5255 | lr 4.35e-06 | tgt 405 | lat 5.22 lon 5.90 mag 4.47
  -> New best val loss!
step   1600 | train 15.5564 | val 15.4736 | lr 4.95e-06 | tgt 404 | lat 5.21 lon 5.90 mag 4.45
  -> New best val loss!
step   1800 | train 15.5148 | val 15.3879 | lr 5.60e-06 | tgt 407 | lat 5.21 lon 5.89 mag 4.42
  -> New best val loss!
[2026-02-12 00:09:30.158811] Checkpoint saved: /var/www/syshuman/quake/eqModel_complex_20260212_000856.pth (iter=1800, loss=15.5148)
